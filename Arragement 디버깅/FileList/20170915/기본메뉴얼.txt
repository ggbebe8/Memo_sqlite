
## 컨버전 사전작업 ## 
컨버전 할 치과 dbsystem, dentop 디비 복사하여 내자리에서 직접 오류 안나는지 테스트 해본다.


eChart 에서 iPro로 컨버전 과정

1. \\dentop-nas\New_eChart\데이터 컨버젼\09. eChart에서 i-pro로 폴더 복사

2. C:dentop 폴더에 붙여넣기

3. 00번 폴더에 있는 파일들 Dentop폴더 로 빼주기(bulkinsert파일들임) 
   EX) (\dentop\파일들)	//폴더말고 파일만 복사하면 돼
   //mBasePoint는 보험, tbMenuinfo는 메뉴에 관한 bulkinsert임

4. INX, RX SP 차례대로 돌리기
   //INX - 보험. 순서에 상관없이 바로
   //RX2 - 메뉴에 관한, RX1 - 테이블이나 컬럼(컬럼이 없다고 나온 경우도 있는데, 밑에 내려가보면 컬럼추가하는 쿼리가 밑에 있음! 그거먼저 돌려줘봐)

5. 컨버전 쿼리(03_컨버전SP실행 폴더) 순서대로 돌려주기 실행한 행 갯수 확인하기
   - 03번 부터는 한 개씩 블록잡아서 돌려주기. SP임. OK갯수 확인.
     03-2번 돌리다가 간혹 오류가 날 때가 있는데, 이거 그냥 다시 돌려주면 돼 ---> 이거 사라짐(문자열이 잘립니다.. 요런거..?)

   - 다 하고 주석부분에 확인 쿼리 돌려주자~확인하는 것.

6. 04번 폴더에 기타 쿼리 돌려주기
   // 인덱스 - 상세검색에 관련된 인덱스임 (한방에 돌려주자)
   // 청구 - (블록잡아서 돌려주자)

7. 05번 폴더에 프로시저 및 함수 스크립트 돌려주기
   //프로시저 및 함수 drop하고 새로 create하는 스크립트

---------------------------------- 
존재하지 않는 테이블 'str_JX_CreateUser'에 의존하고 있으므로 저장 프로시저의 sys.sql_dependencies에 행을 추가할 수 없습니다. 그래도 저장 프로시저는 생성되지만 테이블이 없으면 성공적으로 실행되지 않습니다.
존재하지 않는 테이블 'str_JX_CreateAuthor'에 의존하고 있으므로 저장 프로시저의 sys.sql_dependencies에 행을 추가할 수 없습니다. 그래도 저장 프로시저는 생성되지만 테이블이 없으면 성공적으로 실행되지 않습니다.
존재하지 않는 테이블 'str_JX_CreateUser'에 의존하고 있으므로 저장 프로시저의 sys.sql_dependencies에 행을 추가할 수 없습니다. 그래도 저장 프로시저는 생성되지만 테이블이 없으면 성공적으로 실행되지 않습니다.
----------------------------------
    // 46번에 있는 모든 sp를 넣어주는 것이기 때문에 이런 오류가 나도 상관 x



##### 혹시나!!! 사업자번호가 바뀔 경우 clinic 테이블에서 바꿔주고 업데이트 하면 된다. 이런 일은 거의 없다. 
      참고로 bizNo 컬럼이다!!!  이름은 ClinicName 

8. 레지스트리로 업데이트 날짜 편집 // 없으면 생성
 - Local_Machine - dentop - scriptdate - 값 : 20161201 (무조건 이 날짜)

9. 이차트서버 종료 후 아이프로서버 폴더에서 아이프로서버 시작  (아이프로서버 폴더에서 아이프로서버 시작(exe파일 우클릭-속성-호환성탭에서 관리자권한 체크 해주기))
//
( 업데이트하면서의) cmd창에서 'sqlcmd' 명령어 오류 안나는지 
                   확인 후 오류나면 박차장님께 전달 (업데이트시 SP안돌 수 있음)


10. 설치사원 이름 넣어주고 확인 
   //거기 가 있는 사원임.
   //인증번호는 자동임.  

----- 순서가 중요. 인증이 꼬일 수 있어. ---  // 업데이트받고 인터넷에서 인증받는 것. 이 순서가 맞음. 
	//업데이트 후 로그를 꼭 확인하자


11. Update사이트-인증관리-병원사업자번호(select BizNo from Clinic) 로 검색 
   - eChart에서 iPro로 변경, 해당 병원 체크 후 젤 위에 올라가서 설정저장 하기
   - 참고로 iPro(보험)은 진료 기능의 제한이 있고 iPro(차트)는 기능 제한이 없음
   - 아이프로에서는 모두 iPro(차트)로 한다. 

12. 덴탑폴더에 넣어놨던 파일들 삭제처리

13. 아이프로 실행해서 오류나는 곳 없는지 체크 후 컨버전 종료

14. 혹시 오류가 날 경우, 테이블이 없어서 그럴 수 있음. 2016년 10월쯤으로 업데이트 새로 받아버리자. 

15. 진료, 접수, 환자, ,보험, 예약 정도 들어가서 메뉴 잘 뜨는지만 확인해줘.

**180315 보험 버튼을 누르니까 예외를 throw했다고 나옴
 - ndt.inx.client.dll  이 파일이 없었던 것. 
 - 예전 setup파일로 아이프로를 설치한 것 같아(파일 자체가 없으면 업데이트로 엎어지지 않아)
 - 해당 파일을 따로 깔아줌. -- cs팀 실수인 듯.

**iPRO 서버로 디비 못붙여준 경우
1. 백업폴더에서 Dentop, dbSystem, dbImage 백업파일 복원
- 복원시 옵션에서 mdf파일 경로 C:Dentop\iPRO Server\DBLog 폴더로 변경


**기존 sa암호와 다른경우 설정 바꿔줘야함 
  1. conninfo.xml 셋팅파일 내부에 셋팅되어있던 <Server>단의 암호<PW> 안에 내역 지워줌 (암호화되어있는 비번임)
  2. 아이프로 서버 올린 뒤 설정 다시 넣어주고, 저장후 서버 재실행. 
  3. 클라이언트 자리 배치정보도 다 바꾼암호로 저장해줘야함!!!


** 180320 : 메뉴(접수,수납,수납자료)를 눌렀을 때 "등록되지 않은 메뉴입니다."라고 나오는 경우
 - 03. 에 마지막 쿼리를 안돌렷어 ㅜㅜㅜㅜ 

** 180320 : 업데이트를 다 하고 죽는 경우
 - 로그 먼저 확인. 업데이트 완료가 떠 있으면, 괜찮. 컴퓨터 사양이 나쁘면 가끔 이런다고 함.

** 180320 : 아이프로 클라이언트를 실행시키면 ~~ 테이블이 없다고 나옴 
 - 날짜를 땡겨서 다시 업데이트 해보자. 2016.06.01 

** 180628 : 진료탭에 들어가면 80040154 오류로 인해~~ 뭐시기 하며 안뜨는 경우가 있음. 이럴 땐, 클라이언트 배치 클라이언트에서 체크 하고 나오는 거
            설치하고 진행하면 잘 된다.!


